<nav class="navbar">
  <div class="navbar-container">
    <div class="navbar-brand">
      <%= link_to root_path, class: "brand-link" do %>
        <span class="brand-text">Mahi</span>
      <% end %>
    </div>

    <button class="navbar-toggle" id="navbar-toggle" aria-label="Toggle navigation" aria-expanded="false">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>

    <div class="navbar-menu" id="navbar-menu">
      <% if user_signed_in? %>
        <%= link_to "Body Goals", body_goals_path, class: "navbar-link" %>
        <%= link_to "Check-ins", body_snapshots_path, class: "navbar-link" %>
        <%= link_to "New Goal", new_body_goal_path, class: "navbar-link" %>
        <%= link_to "Record Check-in", new_body_snapshot_path, class: "navbar-link" %>
        <div class="navbar-divider"></div>
        <%= link_to "Sign Out", destroy_user_session_path, data: { turbo_method: :delete }, class: "navbar-link navbar-link-danger" %>
      <% else %>
        <%= link_to "Sign In", new_user_session_path, class: "navbar-link" %>
        <%= link_to "Sign Up", new_user_registration_path, class: "navbar-link navbar-link-primary" %>
      <% end %>
    </div>
  </div>
</nav>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const toggle = document.getElementById('navbar-toggle');
    const menu = document.getElementById('navbar-menu');
    
    if (toggle && menu) {
      toggle.addEventListener('click', function() {
        const isExpanded = toggle.getAttribute('aria-expanded') === 'true';
        toggle.setAttribute('aria-expanded', !isExpanded);
        menu.classList.toggle('navbar-menu-open');
        toggle.classList.toggle('navbar-toggle-open');
      });

      // Close menu when clicking outside
      document.addEventListener('click', function(event) {
        const isClickInside = menu.contains(event.target) || toggle.contains(event.target);
        if (!isClickInside && menu.classList.contains('navbar-menu-open')) {
          menu.classList.remove('navbar-menu-open');
          toggle.classList.remove('navbar-toggle-open');
          toggle.setAttribute('aria-expanded', 'false');
        }
      });

      // Close menu when clicking on a link (mobile)
      const links = menu.querySelectorAll('.navbar-link');
      links.forEach(function(link) {
        link.addEventListener('click', function() {
          if (window.innerWidth <= 768) {
            menu.classList.remove('navbar-menu-open');
            toggle.classList.remove('navbar-toggle-open');
            toggle.setAttribute('aria-expanded', 'false');
          }
        });
      });
    }
  });
</script>

